export class MemoryAdapter {
    namespaces = new Map();
    checkNamespace(ns) {
        if (this.namespaces.has(ns)) return;
        else this.namespaces.set(ns, new Map());
    }
    ns(ns) {
        this.checkNamespace(ns);
        return this.namespaces.get(ns);
    }
    // deno-lint-ignore no-explicit-any
    set(k, v, ns = "", ttl = 0) {
        const n = this.ns(ns);
        n?.set(k, {
            value: v,
            ttl
        });
        return this;
    }
    get(k, ns = "") {
        const n = this.ns(ns);
        const v = n?.get(k);
        return !v ? undefined : {
            key: k,
            ns,
            value: v.value,
            ttl: v.ttl
        };
    }
    has(k, ns = "") {
        return this.ns(ns)?.has(k) ?? false;
    }
    delete(k, ns = "") {
        const n = this.ns(ns);
        return n?.delete(k) ?? false;
    }
    keys(ns = "") {
        return [
            ...this.ns(ns)?.keys() ?? []
        ];
    }
    clear(ns = "") {
        this.namespaces.set(ns, new Map());
        return this;
    }
    deleteExpired(ns = "") {
        const n = this.ns(ns);
        for (const e of n.entries()){
            if (e[1].ttl !== 0 && Date.now() > e[1].ttl) {
                n.delete(e[0]);
            }
        }
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImh0dHBzOi8vZGVuby5sYW5kL3gva2V5ZGJAMS4wLjAvbWVtb3J5LnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFkYXB0ZXIgfSBmcm9tIFwiLi9hZGFwdGVyLnRzXCI7XHJcblxyXG5leHBvcnQgY2xhc3MgTWVtb3J5QWRhcHRlciBpbXBsZW1lbnRzIEFkYXB0ZXIge1xyXG4gIG5hbWVzcGFjZXM6IE1hcDxcclxuICAgIHN0cmluZyxcclxuICAgIE1hcDxzdHJpbmcsIHsgdmFsdWU6IHN0cmluZzsgdHRsOiBudW1iZXIgfT5cclxuICA+ID0gbmV3IE1hcCgpO1xyXG5cclxuICBjaGVja05hbWVzcGFjZShuczogc3RyaW5nKSB7XHJcbiAgICBpZiAodGhpcy5uYW1lc3BhY2VzLmhhcyhucykpIHJldHVybjtcclxuICAgIGVsc2UgdGhpcy5uYW1lc3BhY2VzLnNldChucywgbmV3IE1hcCgpKTtcclxuICB9XHJcblxyXG4gIG5zKG5zOiBzdHJpbmcpIHtcclxuICAgIHRoaXMuY2hlY2tOYW1lc3BhY2UobnMpO1xyXG4gICAgcmV0dXJuIHRoaXMubmFtZXNwYWNlcy5nZXQobnMpO1xyXG4gIH1cclxuXHJcbiAgLy8gZGVuby1saW50LWlnbm9yZSBuby1leHBsaWNpdC1hbnlcclxuICBzZXQoazogc3RyaW5nLCB2OiBhbnksIG5zID0gXCJcIiwgdHRsID0gMCkge1xyXG4gICAgY29uc3QgbiA9IHRoaXMubnMobnMpO1xyXG4gICAgbj8uc2V0KGssIHsgdmFsdWU6IHYsIHR0bCB9KTtcclxuICAgIHJldHVybiB0aGlzO1xyXG4gIH1cclxuXHJcbiAgZ2V0KGs6IHN0cmluZywgbnMgPSBcIlwiKSB7XHJcbiAgICBjb25zdCBuID0gdGhpcy5ucyhucyk7XHJcbiAgICBjb25zdCB2ID0gbj8uZ2V0KGspO1xyXG4gICAgcmV0dXJuICF2ID8gdW5kZWZpbmVkIDogeyBrZXk6IGssIG5zLCB2YWx1ZTogdi52YWx1ZSwgdHRsOiB2LnR0bCB9O1xyXG4gIH1cclxuXHJcbiAgaGFzKGs6IHN0cmluZywgbnMgPSBcIlwiKSB7XHJcbiAgICByZXR1cm4gdGhpcy5ucyhucyk/LmhhcyhrKSA/PyBmYWxzZTtcclxuICB9XHJcblxyXG4gIGRlbGV0ZShrOiBzdHJpbmcsIG5zID0gXCJcIikge1xyXG4gICAgY29uc3QgbiA9IHRoaXMubnMobnMpO1xyXG4gICAgcmV0dXJuIG4/LmRlbGV0ZShrKSA/PyBmYWxzZTtcclxuICB9XHJcblxyXG4gIGtleXMobnMgPSBcIlwiKSB7XHJcbiAgICByZXR1cm4gWy4uLih0aGlzLm5zKG5zKT8ua2V5cygpID8/IFtdKV07XHJcbiAgfVxyXG5cclxuICBjbGVhcihucyA9IFwiXCIpIHtcclxuICAgIHRoaXMubmFtZXNwYWNlcy5zZXQobnMsIG5ldyBNYXAoKSk7XHJcbiAgICByZXR1cm4gdGhpcztcclxuICB9XHJcblxyXG4gIGRlbGV0ZUV4cGlyZWQobnMgPSBcIlwiKSB7XHJcbiAgICBjb25zdCBuID0gdGhpcy5ucyhucykhO1xyXG4gICAgZm9yIChjb25zdCBlIG9mIG4uZW50cmllcygpKSB7XHJcbiAgICAgIGlmIChlWzFdLnR0bCAhPT0gMCAmJiBEYXRlLm5vdygpID4gZVsxXS50dGwpIHtcclxuICAgICAgICBuLmRlbGV0ZShlWzBdKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxufVxyXG4iXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBRUEsT0FBTyxNQUFNLGFBQWE7SUFDeEIsVUFBVSxHQUdOLElBQUksR0FBRyxFQUFFLENBQUM7SUFFZCxjQUFjLENBQUMsRUFBVSxFQUFFO1FBQ3pCLElBQUksSUFBSSxDQUFDLFVBQVUsQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEVBQUUsT0FBTzthQUMvQixJQUFJLENBQUMsVUFBVSxDQUFDLEdBQUcsQ0FBQyxFQUFFLEVBQUUsSUFBSSxHQUFHLEVBQUUsQ0FBQyxDQUFDO0tBQ3pDO0lBRUQsRUFBRSxDQUFDLEVBQVUsRUFBRTtRQUNiLElBQUksQ0FBQyxjQUFjLENBQUMsRUFBRSxDQUFDLENBQUM7UUFDeEIsT0FBTyxJQUFJLENBQUMsVUFBVSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsQ0FBQztLQUNoQztJQUVELG1DQUFtQztJQUNuQyxHQUFHLENBQUMsQ0FBUyxFQUFFLENBQU0sRUFBRSxFQUFFLEdBQUcsRUFBRSxFQUFFLEdBQUcsR0FBRyxDQUFDLEVBQUU7UUFDdkMsTUFBTSxDQUFDLEdBQUcsSUFBSSxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsQUFBQztRQUN0QixDQUFDLEVBQUUsR0FBRyxDQUFDLENBQUMsRUFBRTtZQUFFLEtBQUssRUFBRSxDQUFDO1lBQUUsR0FBRztTQUFFLENBQUMsQ0FBQztRQUM3QixPQUFPLElBQUksQ0FBQztLQUNiO0lBRUQsR0FBRyxDQUFDLENBQVMsRUFBRSxFQUFFLEdBQUcsRUFBRSxFQUFFO1FBQ3RCLE1BQU0sQ0FBQyxHQUFHLElBQUksQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEFBQUM7UUFDdEIsTUFBTSxDQUFDLEdBQUcsQ0FBQyxFQUFFLEdBQUcsQ0FBQyxDQUFDLENBQUMsQUFBQztRQUNwQixPQUFPLENBQUMsQ0FBQyxHQUFHLFNBQVMsR0FBRztZQUFFLEdBQUcsRUFBRSxDQUFDO1lBQUUsRUFBRTtZQUFFLEtBQUssRUFBRSxDQUFDLENBQUMsS0FBSztZQUFFLEdBQUcsRUFBRSxDQUFDLENBQUMsR0FBRztTQUFFLENBQUM7S0FDcEU7SUFFRCxHQUFHLENBQUMsQ0FBUyxFQUFFLEVBQUUsR0FBRyxFQUFFLEVBQUU7UUFDdEIsT0FBTyxJQUFJLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLEdBQUcsQ0FBQyxDQUFDLENBQUMsSUFBSSxLQUFLLENBQUM7S0FDckM7SUFFRCxNQUFNLENBQUMsQ0FBUyxFQUFFLEVBQUUsR0FBRyxFQUFFLEVBQUU7UUFDekIsTUFBTSxDQUFDLEdBQUcsSUFBSSxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsQUFBQztRQUN0QixPQUFPLENBQUMsRUFBRSxNQUFNLENBQUMsQ0FBQyxDQUFDLElBQUksS0FBSyxDQUFDO0tBQzlCO0lBRUQsSUFBSSxDQUFDLEVBQUUsR0FBRyxFQUFFLEVBQUU7UUFDWixPQUFPO2VBQUssSUFBSSxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFO1NBQUUsQ0FBQztLQUN6QztJQUVELEtBQUssQ0FBQyxFQUFFLEdBQUcsRUFBRSxFQUFFO1FBQ2IsSUFBSSxDQUFDLFVBQVUsQ0FBQyxHQUFHLENBQUMsRUFBRSxFQUFFLElBQUksR0FBRyxFQUFFLENBQUMsQ0FBQztRQUNuQyxPQUFPLElBQUksQ0FBQztLQUNiO0lBRUQsYUFBYSxDQUFDLEVBQUUsR0FBRyxFQUFFLEVBQUU7UUFDckIsTUFBTSxDQUFDLEdBQUcsSUFBSSxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsQUFBQyxBQUFDO1FBQ3ZCLEtBQUssTUFBTSxDQUFDLElBQUksQ0FBQyxDQUFDLE9BQU8sRUFBRSxDQUFFO1lBQzNCLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUcsS0FBSyxDQUFDLElBQUksSUFBSSxDQUFDLEdBQUcsRUFBRSxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLEVBQUU7Z0JBQzNDLENBQUMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7YUFDaEI7U0FDRjtLQUNGO0NBQ0YifQ==